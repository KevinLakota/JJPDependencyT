package Model;

import java.util.Objects;

public class Vulnerability {
    private String packageName;
    private String packageVersion;
    private String source;
    private String cveId;
    private String severity;
    private String description;

    public Vulnerability(String packageName, String packageVersion, String source, String cveId, String severity, String description) {
        this.packageName = packageName;
        this.packageVersion = packageVersion;
        this.source = source;
        this.cveId = cveId;
        this.severity = severity;
        this.description = description;
    }

    public String getPackageName() {
        return packageName;
    }

    public String getPackageVersion() {
        return packageVersion;
    }

    public String getSource() {
        return source;
    }

    public String getCveId() {
        return cveId;
    }

    public String getSeverity() {
        return severity;
    }

    public String getDescription() {
        return description;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof Vulnerability)) return false;
        Vulnerability that = (Vulnerability) o;
        return Objects.equals(packageName, that.packageName) &&
                Objects.equals(packageVersion, that.packageVersion) &&
                Objects.equals(source, that.source) &&
                Objects.equals(cveId, that.cveId);
    }

    @Override
    public int hashCode() {
        return Objects.hash(packageName, packageVersion, source, cveId);
    }

    @Override
    public String toString() {
        return "[" + cveId + "] " + packageName + "@" + packageVersion + " (" + severity + ")";
    }
}
